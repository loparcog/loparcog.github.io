<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Silly Sound's Sesame üê± | giacomo</title><meta name=keywords content="synth,vcv rack"><meta name=description content="VCV Rack eurorack module for clock modulation, specifically a merger of a swing and burst signal modulator."><meta name=author content="Giacomo Loparco"><link rel=canonical href=https://loparcog.github.io/posts/2211sesame/><link crossorigin=anonymous href=/assets/css/stylesheet.f417b2b78a51a3f1015eb588a750379d079f7aca74d3fc689d30c120942e444c.css integrity="sha256-9Beyt4pRo/EBXrWIp1A3nQefesp00/xonTDBIJQuREw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://loparcog.github.io/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://loparcog.github.io/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://loparcog.github.io/img/favicon-32x32.png><link rel=apple-touch-icon href=https://loparcog.github.io/img/apple-touch-icon.png><link rel=mask-icon href=https://loparcog.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><meta property="og:title" content="Silly Sound's Sesame üê±"><meta property="og:description" content="VCV Rack eurorack module for clock modulation, specifically a merger of a swing and burst signal modulator."><meta property="og:type" content="article"><meta property="og:url" content="https://loparcog.github.io/posts/2211sesame/"><meta property="og:image" content="https://loparcog.github.io/img/pfp.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-24T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-24T00:00:00+00:00"><meta property="og:site_name" content="giacomo"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://loparcog.github.io/img/pfp.png"><meta name=twitter:title content="Silly Sound's Sesame üê±"><meta name=twitter:description content="VCV Rack eurorack module for clock modulation, specifically a merger of a swing and burst signal modulator."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://loparcog.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Silly Sound's Sesame üê±","item":"https://loparcog.github.io/posts/2211sesame/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Silly Sound's Sesame üê±","name":"Silly Sound\u0027s Sesame üê±","description":"VCV Rack eurorack module for clock modulation, specifically a merger of a swing and burst signal modulator.","keywords":["synth","vcv rack"],"articleBody":"Feel free to check out this and other Silly Sound modules at the GitHub codebase (they‚Äôre well commented I swear). All of the code mentioned in this article can be found in src/Sesame.cpp\nAlso if you are wondering, Silly Sounds is a mock Eurorack module company that these plugins will be published under. The company has and will never have profits, but is also a fake company, so we are planned to meet our goals year over year.\nWhat is it Sesame is a VCV Rack module which takes a standard clock signal as input and modulates it by adding swing and burstfire to the original signal. The swing moves pairs of beats closer together to take away some of the robotic accuracy of the clock and move it towards a jazzier space. The higher the swing, the closer and faster the beats in the pair are, and the farther apart the pairs are from one another.\nThe repeater, or burstfire, or whatever you would like to call it, essentially divides a single clock high into multiple smaller high signal. The repeater can be actuated on a beat-by-beat basis, and the number of beats the original beat is divided into can be moved from 1 to 8 times (8 is not some technological limit, I just think things get muddy and messy past that and don‚Äôt see a use case). Both the amount of swing and number of beats the repeater puts out can be modulated automatically with an input signal, allowing these parameters to organically grow and shrink given any range of input.\nSesame module plugged into a scope, showing clock input on the bottom and modulated output on the top How each part works Sesame is a three-parter in terms of code chunks. The first thing both the swing and repeat portions need is a measure of the current tempo. To do this, I have a timer tracking the time between rises from the clock signal, and I keep the latest gap between signals as the clock period. Every sample period (how often the module process is called, commonly around the 48Hz mark for VCV Rack), a Schmitt Trigger processes the current clock input to check for a clock rise. If there is a rise, we record the period and restart the timer. Otherwise, we continue.\n// Schmitt trigger initialization rack::dsp::SchmittTrigger clockTrigger; ... // Get the current time from the timer currentTime = clockTimer.getTime(); // Check if we are on a clock rise (voltage jump from 0 -\u003e 10) if (clockTrigger.process(inputs[CLOCK_INPUT].getVoltage())) { // Set the current clock period to the current timer time, and reset the timer originalPeriod = currentTime; clockTimer.reset(); // Reset the current time currentTime = 0; } The swing and repeater pieces were coded in separate modules before being combined into Sesame. Because of this, and because it‚Äôs easier to explain and conceptualize, I‚Äôll lay them out first independently. The swing portion looks at the clock signal as pairs of beats, keeping track of which beat is the first and which one is the second. As swing increases in a range from 0-1, we wait longer for the first beat to play, and we end the second beat sooner. The second beat always starts at the same time as the original clock signal.\nmoddedHigh = clockHigh * (1 - swing); // First beat, play when current time is past the adjusted start time // and just play for the adjusted clock high time if (firstBeat) { if (currentTime \u003e= originalPeriod * swing \u0026\u0026 currentTime \u003c= (originalPeriod * swing) + moddedHigh) { outValue = 10; } else { outValue = 0; } } // Second beat, play until current time is more than the adjusted clock high else { if (currentTime \u003e moddedHigh) { outValue = 0; } else { outValue = 10; } } The repeater portion is a little cleaner, tucked away in a formula applied to the current time and clock period. As seen in the image above, the standard clock signal has a high for exactly the first half of its period, and a low for the second half. Since we‚Äôre going to be dividing this up into n equal segments, we can just make an equation to take the clock period and n and output the n highs spaced equally across the original period. When n is 1, this would be the exact same as the input signal, but as n rises, the number of clock highs rises proportionately and those clock highs get smaller and smaller, since they still need to fit in the same original period.\n// Make sure the repeater mod is triggered and we have a valid clock period (\u003e0) if (modOn \u0026\u0026 clockPeriod) { // This outputs to 10 unless we are in the second half of a clock signal, which will make it output 0 outValue = (10 - (int((currentTime * n * 2) / clkPeriod) % 2) * 10); // Turn off mod if it has passed the initial period, avoid constant repeating when original signal stops if (currentTime \u003e= originalPeriod) { modOn = false; } } else { // Send original signal as the passthrough, avoid needless calculations outValue = inValue; } How they work together So the main part of this project was combining these basic modules under one control scheme. The problem that arises is the swing module is set to output the specific highs and lows of the clock w.r.t the current swing value, whereas the repeater module is set to output all highs and lows in a given period w.r.t the current repeating frequency n. Because of this, we can‚Äôt just move the equation from the repeater module into the outValue outputs of the swing module and call it a day. What we can do, however, is shift our view of swing from delaying beats and reducing the high and low times to pairs of beats in their own, much faster frequency. Looking at the problem from this angle allows us to easily calculate a new modded period length, which we can then use the repeater function on. All we need to do then is just make sure the first beat waits the appropriate time before playing, and only two beats are played from this new timing.\n// Calculate the modded period moddedPeriod = originalPeriod * (1 - swing); if (isFirstBeat) { // Wait until the current time reaches the start of the modded period time if (currentTime \u003e= clockPeriod - moddedPeriod) { /* This output is set to 10 for half of the mod period, and 0 for the second half, as regular clock signals would be. However, this is done through some repeater math as well. Essentially, for n repeats, we are dividing the period into n groups, each group having the first half high (10) and the second half low (0). If there is no repeater trigger, n is set to 1 to mimic just a single beat Also note the time calculation at the start, allowing the equation to mimic starting at t=0, rather than t=(clockPeriod - moddedPeriod) */ outValue = (10 - (int(((currentTime - (clockPeriod - moddedPeriod)) * n * 2) / moddedPeriod) % 2) * 10); } } // If we're on the second beat, we want to play until we reach the end of the modded // period time, always starting at the rise of the original second beat else if (clkCurrent \u003c= modPeriod) { // Same math, don't need the clock calculation though since we start at the same // time as the original second beat, so t=0 outValue = (10 - (int((currentTime * n * 2) / moddedPeriod) % 2) * 10); } Conclusion and considerations This basic clock module was a great dive-in to VCV Rack‚Äôs development space, and into some signal processing itself. The next step to take ideally would be to start dealing with actual sound waves, which I aim to do through the use of a live feed-through sampler and repeater.\nIn terms of upgrades, a delay could always be added on to this module as well, and I found in use that a button to flip which beats are viewed as first and second could be helpful in properly synchronizing the swing to your current beat. Since this isn‚Äôt in VCV Rack currently, it‚Äôll still be considered under development and I may add them before submitting, but we‚Äôll see. For now, you can always clone the Silly Sounds repo and build the plugin locally to access it on your local VCV Rack setup using this handy guide.\n","wordCount":"1432","inLanguage":"en","datePublished":"2022-11-24T00:00:00Z","dateModified":"2022-11-24T00:00:00Z","author":{"@type":"Person","name":"Giacomo Loparco"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://loparcog.github.io/posts/2211sesame/"},"publisher":{"@type":"Organization","name":"giacomo","logo":{"@type":"ImageObject","url":"https://loparcog.github.io/img/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://loparcog.github.io/ accesskey=h title="giacomo (Alt + H)">giacomo</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://loparcog.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://loparcog.github.io/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://loparcog.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://loparcog.github.io/posts/>Posts</a></div><h1 class=post-title>Silly Sound's Sesame üê±</h1><div class=post-meta><span title='2022-11-24 00:00:00 +0000 UTC'>November 24, 2022</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;Giacomo Loparco</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#what-is-it>What is it</a></li><li><a href=#how-each-part-works>How each part works</a></li><li><a href=#how-they-work-together>How they work <em>together</em></a></li><li><a href=#conclusion-and-considerations>Conclusion and considerations</a></li></ul></nav></div></details></div><div class=post-content><p><em>Feel free to check out this and other Silly Sound modules at <a href=https://github.com/loparcog/SillySounds>the GitHub codebase</a> (they&rsquo;re well commented I swear). All of the code mentioned in this article can be found in <a href=https://github.com/loparcog/SillySounds/blob/master/src/Sesame.cpp>src/Sesame.cpp</a></em></p><p><em>Also if you are wondering, Silly Sounds is a mock Eurorack module company that these plugins will be published under. The company has and will never have profits, but is also a fake company, so we are planned to meet our goals year over year.</em></p><h2 id=what-is-it>What is it<a hidden class=anchor aria-hidden=true href=#what-is-it>#</a></h2><p><strong>Sesame</strong> is a VCV Rack module which takes a standard clock signal as input and modulates it by adding swing and burstfire to the original signal. The swing moves pairs of beats closer together to take away some of the robotic accuracy of the clock and move it towards a <em>jazzier</em> space. The higher the swing, the closer and faster the beats in the pair are, and the farther apart the pairs are from one another.</p><p>The repeater, or burstfire, or whatever you would like to call it, essentially divides a single clock high into multiple smaller high signal. The repeater can be actuated on a beat-by-beat basis, and the number of beats the original beat is divided into can be moved from 1 to 8 times (<em>8 is not some technological limit, I just think things get muddy and messy past that and don&rsquo;t see a use case</em>). Both the amount of swing and number of beats the repeater puts out can be modulated automatically with an input signal, allowing these parameters to organically grow and shrink given any range of input.</p><p><figure><img src=/img/sesame.png alt="Sesame module in VCV Rack" style=width:100%;display:block;margin:auto><figcaption style=text-align:center;font-style:italic>Sesame module plugged into a scope, showing clock input on the bottom and modulated output on the top</figcaption></figure></p><h2 id=how-each-part-works>How each part works<a hidden class=anchor aria-hidden=true href=#how-each-part-works>#</a></h2><p>Sesame is a three-parter in terms of code chunks. The first thing both the swing and repeat portions need is a measure of the current tempo. To do this, I have a timer tracking the time between rises from the clock signal, and I keep the latest gap between signals as the clock period. Every sample period (<em>how often the module process is called, commonly around the 48Hz mark for VCV Rack</em>), a <a href=https://en.wikipedia.org/wiki/Schmitt_trigger>Schmitt Trigger</a> processes the current clock input to check for a clock rise. If there is a rise, we record the period and restart the timer. Otherwise, we continue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// Schmitt trigger initialization
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>rack<span style=color:#f92672>::</span>dsp<span style=color:#f92672>::</span>SchmittTrigger clockTrigger;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Get the current time from the timer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>currentTime <span style=color:#f92672>=</span> clockTimer.getTime();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Check if we are on a clock rise (voltage jump from 0 -&gt; 10)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (clockTrigger.process(inputs[CLOCK_INPUT].getVoltage()))
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Set the current clock period to the current timer time, and reset the timer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    originalPeriod <span style=color:#f92672>=</span> currentTime;
</span></span><span style=display:flex><span>    clockTimer.reset();
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Reset the current time
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    currentTime <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The swing and repeater pieces were coded in separate modules before being combined into Sesame. Because of this, and because it&rsquo;s easier to explain and conceptualize, I&rsquo;ll lay them out first independently. The <strong>swing</strong> portion looks at the clock signal as pairs of beats, keeping track of which beat is the first and which one is the second. As swing increases in a range from 0-1, we wait longer for the first beat to play, and we end the second beat sooner. The second beat always starts at the same time as the original clock signal.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>moddedHigh <span style=color:#f92672>=</span> clockHigh <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> swing);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// First beat, play when current time is past the adjusted start time
</span></span></span><span style=display:flex><span><span style=color:#75715e>// and just play for the adjusted clock high time
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (firstBeat)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (currentTime <span style=color:#f92672>&gt;=</span> originalPeriod <span style=color:#f92672>*</span> swing <span style=color:#f92672>&amp;&amp;</span> 
</span></span><span style=display:flex><span>    currentTime <span style=color:#f92672>&lt;=</span> (originalPeriod <span style=color:#f92672>*</span> swing) <span style=color:#f92672>+</span> moddedHigh)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        outValue <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        outValue <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// Second beat, play until current time is more than the adjusted clock high
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (currentTime <span style=color:#f92672>&gt;</span> moddedHigh)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        outValue <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        outValue <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The <strong>repeater</strong> portion is a little cleaner, tucked away in a formula applied to the current time and clock period. As seen in the image above, the standard clock signal has a high for exactly the first half of its period, and a low for the second half. Since we&rsquo;re going to be dividing this up into <em>n</em> equal segments, we can just make an equation to take the clock period and <em>n</em> and output the <em>n</em> highs spaced equally across the original period. When <em>n</em> is 1, this would be the exact same as the input signal, but as <em>n</em> rises, the number of clock highs rises proportionately and those clock highs get smaller and smaller, since they still need to fit in the same original period.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// Make sure the repeater mod is triggered and we have a valid clock period (&gt;0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> (modOn <span style=color:#f92672>&amp;&amp;</span> clockPeriod)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// This outputs to 10 unless we are in the second half of a clock signal, which will make it output 0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    outValue <span style=color:#f92672>=</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>-</span> (<span style=color:#66d9ef>int</span>((currentTime <span style=color:#f92672>*</span> n <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> clkPeriod) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Turn off mod if it has passed the initial period, avoid constant repeating when original signal stops
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (currentTime <span style=color:#f92672>&gt;=</span> originalPeriod)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        modOn <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Send original signal as the passthrough, avoid needless calculations
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    outValue <span style=color:#f92672>=</span> inValue;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=how-they-work-together>How they work <em>together</em><a hidden class=anchor aria-hidden=true href=#how-they-work-together>#</a></h2><p>So the main part of this project was combining these basic modules under one control scheme. The problem that arises is the swing module is set to output the specific highs and lows of the clock w.r.t the current swing value, whereas the repeater module is set to output all highs and lows in a given period w.r.t the current repeating frequency <em>n</em>. Because of this, we can&rsquo;t just move the equation from the repeater module into the <code>outValue</code> outputs of the swing module and call it a day. What we <em>can</em> do, however, is shift our view of swing from delaying beats and reducing the high and low times to pairs of beats in their own, much faster frequency. Looking at the problem from this angle allows us to easily calculate a new modded period length, which we can then use the repeater function on. All we need to do then is just make sure the first beat waits the appropriate time before playing, and only two beats are played from this new timing.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// Calculate the modded period
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>moddedPeriod <span style=color:#f92672>=</span> originalPeriod <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> swing);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (isFirstBeat)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Wait until the current time reaches the start of the modded period time
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (currentTime <span style=color:#f92672>&gt;=</span> clockPeriod <span style=color:#f92672>-</span> moddedPeriod)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>            This output is set to 10 for half of the mod period, and 0 for the second
</span></span></span><span style=display:flex><span><span style=color:#75715e>            half, as regular clock signals would be. However, this is done through
</span></span></span><span style=display:flex><span><span style=color:#75715e>            some repeater math as well. Essentially, for n repeats, we are dividing the
</span></span></span><span style=display:flex><span><span style=color:#75715e>            period into n groups, each group having the first half high (10) and the
</span></span></span><span style=display:flex><span><span style=color:#75715e>            second half low (0). If there is no repeater trigger, n
</span></span></span><span style=display:flex><span><span style=color:#75715e>            is set to 1 to mimic just a single beat
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>            Also note the time calculation at the start, allowing the equation to mimic
</span></span></span><span style=display:flex><span><span style=color:#75715e>            starting at t=0, rather than t=(clockPeriod - moddedPeriod)
</span></span></span><span style=display:flex><span><span style=color:#75715e>        */</span>
</span></span><span style=display:flex><span>        outValue <span style=color:#f92672>=</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>-</span> (<span style=color:#66d9ef>int</span>(((currentTime <span style=color:#f92672>-</span> (clockPeriod <span style=color:#f92672>-</span> moddedPeriod)) <span style=color:#f92672>*</span> n <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> moddedPeriod) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// If we&#39;re on the second beat, we want to play until we reach the end of the modded
</span></span></span><span style=display:flex><span><span style=color:#75715e>// period time, always starting at the rise of the original second beat
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>else</span> <span style=color:#a6e22e>if</span> (clkCurrent <span style=color:#f92672>&lt;=</span> modPeriod)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Same math, don&#39;t need the clock calculation though since we start at the same
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// time as the original second beat, so t=0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    outValue <span style=color:#f92672>=</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>-</span> (<span style=color:#66d9ef>int</span>((currentTime <span style=color:#f92672>*</span> n <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> moddedPeriod) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=conclusion-and-considerations>Conclusion and considerations<a hidden class=anchor aria-hidden=true href=#conclusion-and-considerations>#</a></h2><p>This basic clock module was a great dive-in to VCV Rack&rsquo;s development space, and into some signal processing itself. The next step to take ideally would be to start dealing with actual sound waves, which I aim to do through the use of a live feed-through sampler and repeater.</p><p>In terms of upgrades, a delay could always be added on to this module as well, and I found in use that a button to flip which beats are viewed as first and second could be helpful in properly synchronizing the swing to your current beat. Since this isn&rsquo;t in VCV Rack currently, it&rsquo;ll still be considered <em>under development</em> and I may add them before submitting, but we&rsquo;ll see. For now, you can always clone the Silly Sounds repo and build the plugin locally to access it on your local VCV Rack setup using <a href=https://vcvrack.com/manual/Building>this handy guide</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://loparcog.github.io/tags/synth/>synth</a></li><li><a href=https://loparcog.github.io/tags/vcv-rack/>vcv rack</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://loparcog.github.io/>giacomo</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>